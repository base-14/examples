# Database Configuration
spring.datasource.platform=mysql
spring.datasource.url=jdbc:mysql://db:3306/company?createDatabaseIfNotExist=true&useSSL=false&allowPublicKeyRetrieval=true
spring.datasource.username=root
spring.datasource.password=123456
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver
spring.datasource.testWhileIdle=true
spring.datasource.validationQuery=SELECT 1

# JPA/Hibernate Configuration
spring.jpa.hibernate.ddl-auto=update
spring.jpa.hibernate.naming-strategy=org.hibernate.cfg.ImprovedNamingStrategy
spring.jpa.properties.hibernate.format_sql=true
# Uncomment to log SQL to console (dev only)
# spring.jpa.show-sql=true

# Service Identification
spring.application.name=${SPRING_APPLICATION_NAME:java-spring-boot-otel}
server.port=8080
service.address=0.0.0.0

# Micrometer Tracing (works with OpenTelemetry)
management.metrics.enable.all=true
management.tracing.enabled=true
management.tracing.sampling.probability=1.0
management.tracing.propagation.type=w3c

# ===== OpenTelemetry Configuration =====

# Automatic Instrumentation
otel.sdk.disabled=false
otel.java.global-autoconfigure.enabled=true
otel.instrumentation.jdbc.enabled=true
otel.instrumentation.spring-webmvc.enabled=true
# Uncomment if using Kafka
# otel.instrumentation.kafka.enabled=true
# Uncomment if using Redis
# otel.instrumentation.redis.enabled=true

# Logback Appender (manually configured in logback-spring.xml with all capture flags)
otel.instrumentation.logback-appender.enabled=true
otel.instrumentation.logback-appender.experimental-log-attributes=true

# OTLP Exporter (overridden by OTEL_EXPORTER_OTLP_* env vars in compose.yaml)
otel.exporter.otlp.protocol=${OTEL_EXPORTER_OTLP_PROTOCOL:http/protobuf}
otel.exporter.otlp.endpoint=${OTEL_EXPORTER_OTLP_ENDPOINT:http://host.docker.internal:4318}

# Signal Exporters
otel.traces.exporter=otlp
otel.metrics.exporter=otlp
otel.logs.exporter=otlp

# Trace Sampling - always_on = 100%
otel.traces.sampler=always_on

# Metrics Export Frequency
otel.metric.export.interval=30s

# Context Propagation
otel.propagators=tracecontext,baggage

# Logging Configuration
logging.level.root=INFO
logging.level.org.springframework=INFO
# Change to INFO in production for reduced log verbosity
logging.level.io.opentelemetry=DEBUG
logging.level.io.micrometer=DEBUG