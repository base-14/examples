# Database Configuration
spring.datasource.platform=postgresql
spring.datasource.url=jdbc:postgresql://db:5432/company
spring.datasource.username=postgres
spring.datasource.password=postgres
spring.datasource.driver-class-name=org.postgresql.Driver

# JPA/Hibernate Configuration
spring.jpa.hibernate.ddl-auto=update
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.properties.hibernate.format_sql=true

# Service Identification
spring.application.name=${SPRING_APPLICATION_NAME:java-spring-boot-otel}
server.port=8080
service.address=0.0.0.0

# Micrometer Tracing (works with OpenTelemetry)
management.metrics.enable.all=true
management.tracing.enabled=true
management.tracing.sampling.probability=1.0
management.tracing.propagation.type=w3c

# ===== OpenTelemetry Configuration =====

# Automatic Instrumentation
otel.sdk.disabled=false
otel.java.global-autoconfigure.enabled=true
otel.instrumentation.jdbc.enabled=true
otel.instrumentation.spring-webmvc.enabled=true

# JDBC Instrumentation - SQL Statement Capture
# Capture full SQL statements in spans (default: true)
otel.instrumentation.jdbc.statement-sanitizer.enabled=true
# Include SQL table names as span attributes (default: true)
otel.instrumentation.common.db-statement-sanitizer.enabled=true

# Logback Appender
otel.instrumentation.logback-appender.enabled=true
otel.instrumentation.logback-appender.experimental-log-attributes=true

# OTLP Exporter (overridden by OTEL_EXPORTER_OTLP_* env vars in compose.yaml)
otel.exporter.otlp.protocol=${OTEL_EXPORTER_OTLP_PROTOCOL:http/protobuf}
otel.exporter.otlp.endpoint=${OTEL_EXPORTER_OTLP_ENDPOINT:http://host.docker.internal:4318}

# Signal Exporters
otel.traces.exporter=otlp
otel.metrics.exporter=otlp
otel.logs.exporter=otlp

# Trace Sampling - always_on = 100%
otel.traces.sampler=always_on

# Metrics Export Frequency
otel.metric.export.interval=30s

# Context Propagation
otel.propagators=tracecontext,baggage

# Logging Configuration
logging.level.root=INFO
logging.level.org.springframework=INFO
logging.level.io.opentelemetry=DEBUG
logging.level.io.micrometer=DEBUG

# HTTP Access Logs - Show all HTTP requests
logging.level.org.springframework.web=DEBUG
server.tomcat.accesslog.enabled=true
server.tomcat.accesslog.pattern=%h %l %u %t "%r" %s %b %D
